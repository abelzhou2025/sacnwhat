# 🔧 修复 Netlify 404 错误

## 问题原因

React 单页应用（SPA）需要将所有路由重定向到 `index.html`，否则直接访问任何路径都会返回 404。

## 解决方案

我已经更新了 `netlify.toml`，添加了 SPA 重定向规则：

```toml
# SPA fallback - redirect all routes to index.html
[[redirects]]
  from = "/*"
  to = "/index.html"
  status = 200
```

## 部署步骤

### 1. 提交更改到 GitHub

```bash
git add netlify.toml
git commit -m "Fix: Add SPA redirect rule for Netlify"
git push
```

### 2. 在 Netlify 重新部署

- Netlify 会自动检测到新的提交并重新部署
- 或者手动触发：Netlify Dashboard → Deploys → Trigger deploy

### 3. 验证修复

部署完成后，访问你的网站，应该可以正常显示了。

## 配置说明

### 重定向规则顺序

1. **Functions 重定向**（优先）
   - 确保 `/.netlify/functions/*` 路径正常工作

2. **SPA 重定向**（最后）
   - 所有其他路径都重定向到 `index.html`

### 为什么需要 status = 200？

使用 `status = 200` 而不是 `301` 或 `302` 重定向，因为：
- 浏览器 URL 保持不变
- 适合 SPA 应用的路由
- 不会影响 SEO

## 其他可能的问题

### 问题 1: 构建失败

检查 Netlify 构建日志：
- 确保 Node.js 版本正确（18+）
- 确保所有依赖都安装了

### 问题 2: 静态资源 404

如果 CSS/JS 文件 404：
- 检查 `vite.config.ts` 中的 `base` 配置
- 确保构建输出在 `dist` 目录

### 问题 3: Functions 不工作

检查：
- 环境变量是否设置（`DEEPSEEK_API_KEY` 或 `GEMINI_API_KEY`）
- Functions 日志是否有错误

## 验证清单

- [ ] `netlify.toml` 包含 SPA 重定向规则
- [ ] 代码已推送到 GitHub
- [ ] Netlify 已重新部署
- [ ] 网站可以正常访问
- [ ] 路由可以正常工作（刷新页面不会 404）

## 测试

部署后测试：
1. 访问首页 ✅
2. 刷新页面 ✅
3. 直接访问任何路径 ✅
4. OCR 功能 ✅

